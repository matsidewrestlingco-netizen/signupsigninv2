<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>signUPsignIN</title>

  <link rel="stylesheet" href="css/base.css" />
  <link rel="stylesheet" href="css/layout.css" />
  <link rel="stylesheet" href="css/components.css" />
</head>

<body>

  <div id="navbar"></div>

  <main class="container">
    <section class="section">
      <h1>Upcoming Events</h1>
      <div id="eventList"></div>
    </section>
  </main>

  <script type="module">
    import { loadNavbar } from "./js/components/navbar.js";
    import { supabase } from "./js/supabaseClient.js";

    loadNavbar();

    const eventList = document.getElementById("eventList");

    async function loadEvents() {
      const { data, error } = await supabase
        .from("events")
        .select("*")
        .order("start_time", { ascending: true });

      if (error) {
        eventList.innerHTML = "<p>Error loading events.</p>";
        return;
      }

      eventList.innerHTML = data
        .map(
          e => `
          <div class="card">
            <h3>${e.title}</h3>
            <p>${new Date(e.start_time).toLocaleString()}</p>
            <a class="btn btn-primary" href="event.html?id=${e.id}">View Event</a>
          </div>
        `
        )
        .join("");
    }

    loadEvents();
  </script>

</body>
</html>