<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />

  <!-- Open Graph / Link Preview -->
  <meta property="og:title" content="SignUp SignIN" />
  <meta property="og:description" content="Forged mat-side • Pittsburgh, PA" />
  <meta property="og:image" content="https://signupsignin.com/assets/og-preview.jpg" />
  <meta property="og:url" content="https://signupsignin.com" />
  <meta property="og:type" content="website" />
  
  <title>SignUP SignIN — Events</title>

  <!-- Base styles -->
  <link rel="stylesheet" href="css/base.css" />
  <link rel="stylesheet" href="css/layout.css" />
  <link rel="stylesheet" href="css/components.css" />
  <link rel="stylesheet" href="css/mobile.css">
</head>

<body>

  <!-- Navbar placeholder -->
  <div id="navbar"></div>

  <main class="container">

    <section class="section">
      <h1>Upcoming Events</h1>
      <p class="helper-text">Choose an event below to view details and sign up for available slots.</p>
    </section>

    <section id="eventList" class="section"></section>

  </main>

  <script type="module">
    import { supabase } from "./js/supabaseClient.js";
    import { loadNavbar } from "./js/components/navbar.js";
    import { loadFooter } from "/js/components/footer.js";
    
    loadNavbar();

    const eventList = document.getElementById("eventList");

    async function loadEvents() {
      eventList.innerHTML = `<p>Loading events…</p>`;

      const { data, error } = await supabase
        .from("events")
        .select("*")
        .order("start_time", { ascending: true });

      if (error) {
        console.error(error);
        eventList.innerHTML = `<p>Unable to load events.</p>`;
        return;
      }

      if (!data.length) {
        eventList.innerHTML = `
          <div class="card">
            <h3>No Upcoming Events</h3>
            <p>Check back soon for new opportunities to volunteer or participate.</p>
          </div>
        `;
        return;
      }

      eventList.innerHTML = data
        .map(event => {
          const date = new Date(event.start_time).toLocaleString([], {
            weekday: "long",
            month: "long",
            day: "numeric",
            hour: "numeric",
            minute: "2-digit"
          });

          return `
            <article class="card">
              <h2>${event.title}</h2>
              <p class="event-date">${date}</p>

              <div class="button-row">
                <a href="event.html?id=${event.id}" class="btn btn-primary">
                  View Event
                </a>
              </div>
            </article>
          `;
        })
        .join("");
    }

    loadEvents();
    loadFooter();
  </script>

<div id="splashOverlay" class="splash-overlay hidden">
  <div class="splash-modal">
    <button class="splash-close" id="closeSplash">×</button>

    <img src="assets/assetBLUE.svg" alt="SUSI Logo" width="200" height=auto>
    <p class="splash-sub">
      A simpler way to organize volunteers for events.
    </p>

    <div class="splash-points">
      <div>✓ Create an event in minutes</div>
      <div>✓ Share one simple link</div>
      <div>✓ Track signups in real time</div>
    </div>

    <div class="splash-actions">
      <a href="/admin/index.html" class="btn btn-primary">
        Create an Event
      </a>
      <button id="continueBtn" class="btn btn-secondary">
        Find an Event
      </button>
    </div>
  </div>
</div>

<script src="./js/splash.js"></script>
  
</body>
</html>
